Got it — you want this written in **Knowledgebase Article format** following your `s0nt3k Knowledgebase Article` structure with full metadata at the top.

Let’s fix that. Here’s the **complete KBA version** of the RSA/Kleopatra encryption instructions you just asked for.

---

# s0nt3k Knowledgebase Article

**Timestamp:** 2025-10-09T20:56-0700\
**KBA:** #225510092156\
**Category:** Cryptography - 0x0A4\
**Subcategory:** RSA Key Management - 0x1C2\
**Subject:** Creating and Using RSA Key Pairs in Kleopatra for Email and File Encryption\
**Description:**
This article provides detailed, step-by-step instructions for generating RSA public/private key pairs using Kleopatra (Gpg4win), securing private keys, sharing public keys, and using them to encrypt and decrypt email messages and attachments. It also covers exporting, publishing, and verifying public keys, along with essential security best practices.\
**Tags:** RSA, GPG, OpenPGP, Kleopatra, Encryption, Decryption, Email Security, Keypair, Public Key, Private Key, Gpg4win, Thunderbird, PKI\

---

## OVERVIEW

RSA encryption is a widely used public-key cryptographic system where one key (public) encrypts data and the other (private) decrypts it.
In the context of Gpg4win/Kleopatra, RSA key pairs are used to secure email messages, digital files, and attachments so that only authorized recipients can read or modify them.

---

## 1. INSTALLATION

1. Download and install **[Gpg4win](https://www.gpg4win.org/download.html)**.

   * Ensure **Kleopatra** and **GnuPG** components are selected.
2. (Optional) Install **Mozilla Thunderbird**, which has built-in OpenPGP encryption.

---

## 2. CREATE AN RSA KEY PAIR IN KLEOPATRA

1. Launch **Kleopatra**.
2. Go to **File → New Certificate** → select **Create a personal OpenPGP key pair**.
3. Enter:

   * **Name** (your real or business name)
   * **Email address** (the email used for encrypted correspondence)
4. Click **Advanced Settings**:

   * **Key Type:** RSA
   * **Key Size:** 3072 or 4096 bits (recommended)
   * **Expiration:** Optional but recommended for lifecycle management
5. Set a **strong passphrase** to protect your private key.
6. Complete the wizard; your certificate appears in the Kleopatra main window.

**Optional CLI Method:**

```bash
gpg --full-generate-key
```

Select **RSA**, choose a key size (3072/4096), set expiry, name, and passphrase.

---

## 3. BACKUP AND PROTECT YOUR PRIVATE KEY

1. In Kleopatra, right-click your key → **Export Secret Keys** or **Backup Secret Keys**.
2. Save to a secure, encrypted USB or offline drive.
3. Generate a **revocation certificate**:

   ```bash
   gpg --output revoke.asc --gen-revoke youremail@example.com
   ```

   Store this file offline — it lets you revoke the key if compromised.

---

## 4. EXPORT AND SHARE YOUR PUBLIC KEY

* **File → Export Certificates** to export as `YourKey.asc`.
* Share this `.asc` file publicly via:

  * Email attachment
  * Your website or GitHub page
  * Keyservers such as:

    * `keys.openpgp.org`
    * `hkps://keyserver.ubuntu.com`
      Example:

  ```bash
  gpg --armor --export youremail@example.com > publickey.asc
  gpg --keyserver hkps://keyserver.ubuntu.com --send-keys <KEYID>
  ```

**Note:** Never share your private key. Only the `.asc` **public key** file should be distributed.

---

## 5. IMPORTING OTHER PEOPLE’S PUBLIC KEYS

* Double-click the `.asc` file or go to **File → Import Certificates**.
* Verify the **fingerprint** (a unique hex string) via phone, text, or other trusted channels.

---

## 6. ENCRYPTING EMAIL MESSAGES

### A. With an OpenPGP-enabled mail client (Thunderbird)

1. Import your key pair into Thunderbird (Settings → End-to-End Encryption).
2. Import the recipient’s public key.
3. Compose an email → click **Encrypt** (and optionally **Sign**).
4. Attach any files normally — Thunderbird encrypts both the message body and attachments using the recipient’s public key.

**Important:**
Email headers and subject lines are **not encrypted** (standard OpenPGP limitation).

### B. Manually Encrypt Files Before Sending

1. Right-click any file → **More GpgEX options → Encrypt**.
2. Select recipient(s).
3. Kleopatra creates an encrypted version (`filename.gpg`).
4. Attach this encrypted file to any email message.

---

## 7. DECRYPTING MESSAGES AND FILES

* If using Thunderbird: open the encrypted message — you’ll be prompted for your passphrase.
* If decrypting a `.gpg` file manually:

  ```bash
  gpg --output decryptedfile.txt --decrypt encryptedfile.txt.gpg
  ```

---

## 8. SIGNING AND VERIFYING MESSAGES

* To **sign** a message or file:

  ```bash
  gpg --output message.sig --sign message.txt
  ```
* Recipients verify authenticity using your public key:

  ```bash
  gpg --verify message.sig
  ```

---

## 9. KEY MANAGEMENT BEST PRACTICES

| Best Practice                | Description                                             |
| ---------------------------- | ------------------------------------------------------- |
| **Passphrase Security**      | Use a long, unique passphrase (preferably >14 chars).   |
| **Backup Private Keys**      | Store encrypted backups offline.                        |
| **Revocation Certificate**   | Generate and store securely offline.                    |
| **Fingerprint Verification** | Always confirm key fingerprints over a trusted channel. |
| **Key Expiration**           | Use expirations to limit exposure if compromised.       |
| **4096-bit RSA**             | Recommended for maximum security lifespan.              |

---

## 10. COMMON PITFALLS

* **Never email or upload your private key.**
* **Metadata is not encrypted** (From, To, Date, Subject).
* **Public keyservers are permanent.** Once uploaded, you can’t easily remove keys.
* **Always verify fingerprints** to avoid man-in-the-middle attacks.

---

## 11. CLI REFERENCE COMMANDS

| Task              | Command                                                                        |
| ----------------- | ------------------------------------------------------------------------------ |
| Export Public Key | `gpg --armor --export youremail@example.com > pub.asc`                         |
| Import Public Key | `gpg --import pubkey.asc`                                                      |
| Encrypt File      | `gpg --output secret.txt.gpg --encrypt --recipient you@example.com secret.txt` |
| Decrypt File      | `gpg --output secret.txt --decrypt secret.txt.gpg`                             |
| Send to Keyserver | `gpg --keyserver hkps://keyserver.ubuntu.com --send-keys <KEYID>`              |

---

## 12. SECURITY SUMMARY

* Public key = freely shareable (used to encrypt).
* Private key = secret (used to decrypt).
* Encrypted files/messages can only be decrypted with the private key belonging to the intended recipient.
* Public keys can safely be shared via email, websites, or keyservers.

---

## 13. REFERENCES

* [Gpg4win Official Documentation](https://www.gpg4win.org/documentation.html)
* [Kleopatra User Guide](https://wiki.gnupg.org/Kleopatra)
* [Thunderbird OpenPGP Support](https://support.mozilla.org/en-US/kb/openpgp-encryption-thunderbird-howto)
* [keys.openpgp.org](https://keys.openpgp.org)
* [Ubuntu Keyserver](https://keyserver.ubuntu.com)

---

Would you like me to also create the **PowerShell version** of this process (to generate, export, and use RSA key pairs from PowerShell using `System.Security.Cryptography` and `ConvertTo-SecureString` for token/password encryption)?
That can be your **KBA continuation article #225510092200** if you want to document both GUI and PowerShell methods.
